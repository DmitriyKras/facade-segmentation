schema: '2.0'
stages:
  prepare:
    cmd: python src/prepare.py
    deps:
    - path: src/prepare.py
      md5: 27960000b763f0ac14992acf76f0e699
      size: 1291
    params:
      prepare_config.json:
        images_folder: data/images
        masks_folder: data/masks
        test_pairs_path: pairs/test_pairs.json
        train_pairs_path: pairs/train_pairs.json
        val_pairs_path: pairs/val_pairs.json
    outs:
    - path: pairs/test_pairs.json
      md5: ecd8c66e594e2e2f987f14c9c8d60709
      size: 2891
    - path: pairs/train_pairs.json
      md5: 9f8bc8e88c3688f7d6fe7ff5fa348e86
      size: 25665
    - path: pairs/val_pairs.json
      md5: c1cbf4b7052a031b2538566b91946d91
      size: 7198
  train:
    cmd: python src/train.py
    deps:
    - path: pairs/train_pairs.json
      md5: 9f8bc8e88c3688f7d6fe7ff5fa348e86
      size: 25665
    - path: pairs/val_pairs.json
      md5: c1cbf4b7052a031b2538566b91946d91
      size: 7198
    - path: src/train.py
      md5: 88fa36776394579312ec684e3bf98b81
      size: 3450
    params:
      train_config.json:
        batch_size: 2
        checkpoint: 0
        checkpoint_folder: weights/checkpoint
        device: GPU
        epochs: 20
        input_shape:
        - 256
        - 256
        load_weights: 0
        loss: binary_crossentropy
        metrics:
        - accuracy
        - precision
        - recall
        optimizer: adam
        train_log_folder: results/training
        train_pairs_path: pairs/train_pairs.json
        train_steps: 100
        val_pairs_path: pairs/val_pairs.json
        val_steps: 20
        weights_load_path: weights/train_weights.h5
        weights_save_path: weights/eval_weights.h5
    outs:
    - path: results/training/train_result.json
      md5: 8c9fac7294432db1c17c870b1eca5596
      size: 3367
    - path: weights/eval_weights.h5
      md5: a33986e3e5da4f00b2dea2e3cfc2679b
      size: 22356264
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: pairs/test_pairs.json
      md5: ecd8c66e594e2e2f987f14c9c8d60709
      size: 2891
    - path: src/evaluate.py
      md5: b9bf6ace3d574b668e6b19b35388ea98
      size: 3328
    - path: weights/eval_weights.h5
      md5: a33986e3e5da4f00b2dea2e3cfc2679b
      size: 22356264
    params:
      evaluate_config.json:
        device: GPU
        evaluate_log_folder: results/evaluation
        input_shape:
        - 256
        - 256
        pairs_path: pairs/test_pairs.json
        plot_PR: 1
        plot_ROC: 1
        threshold: 0.5
        weights_path: weights/eval_weights.h5
    outs:
    - path: results/evaluation/PR_curve.png
      md5: 9e387d3f88d6ab58c2cb632988239e6d
      size: 19479
    - path: results/evaluation/ROC_curve.png
      md5: db744d0486c01e220302999eadc6d644
      size: 19322
    - path: results/evaluation/eval_log.json
      md5: 1dabd2b8fb3df7ca3c52f166c3708274
      size: 193
